{% extends 'base.html' %}
{% block title %}Extrato - Finanças{% endblock %}
{% block content %}

<!-- ===================== SALDO E TOTAIS ===================== -->
<div class="card mb-3">
  <div class="card-body">
    <h5 class="card-title">Saldo:
      <span class="{% if saldo >= 0 %}text-success{% else %}text-danger{% endif %}">R$ {{ saldo }}</span>
    </h5>
    <p class="mb-1">Total Entradas: <span class="entrada">R$ {{ total_entradas }}</span></p>
    <p class="mb-1">Total Saídas: <span class="saida">R$ {{ total_saidas }}</span></p>
    <p class="mb-0">Total Reservas: <span class="reserva">R$ {{ total_reservas }}</span></p>
  </div>
</div>

<!-- ===================== BOTÕES ===================== -->
<div class="d-grid gap-2 d-md-flex mb-3">
  <a href="{% url 'nova_entrada' %}" class="btn btn-success me-md-2">Nova Entrada</a>
  <a href="{% url 'nova_saida' %}" class="btn btn-danger me-md-2">Nova Saída</a>
  <a href="{% url 'nova_reserva' %}" class="btn btn-reserva">Nova Reserva</a> <!-- Botão azul -->
</div>

<!-- ===================== ABAS ===================== -->
<ul class="nav nav-tabs mb-3">
  {% for tab in abas %}
    <li class="nav-item">
      <button class="nav-link {% if forloop.first %}active{% endif %}" data-bs-toggle="tab" data-bs-target="#{{ tab.id }}">{{ tab.label }}</button>
    </li>
  {% endfor %}
</ul>

<!-- ===================== CONTEÚDO DAS ABAS ===================== -->
<div class="tab-content">
  {% for tab in abas %}
    <div class="tab-pane fade {% if forloop.first %}show active{% endif %}" id="{{ tab.id }}">
      
      {% if tab.id == 'extrato' %}
        {% for item in extrato %}
          {% include 'partials/transacao_card.html' with item=item %}
        {% empty %}
          <p class="text-center text-muted">Nenhuma transação.</p>
        {% endfor %}

      {% elif tab.id == 'entradas' %}
        {% for item in entradas %}
          {% include 'partials/transacao_card.html' with item=item %}
        {% empty %}
          <p class="text-center text-muted">Nenhuma entrada registrada.</p>
        {% endfor %}

      {% elif tab.id == 'saidas' %}
        {% for item in saidas %}
          {% include 'partials/transacao_card.html' with item=item %}
        {% empty %}
          <p class="text-center text-muted">Nenhuma saída registrada.</p>
        {% endfor %}

      {% elif tab.id == 'reservas' %}
        {% for item in reservas %}
          {% include 'partials/transacao_card.html' with item=item %}
        {% empty %}
          <p class="text-center text-muted">Nenhuma reserva registrada.</p>
        {% endfor %}

      {% endif %}
      
    </div>
  {% endfor %}
</div>

<!-- ===================== BOTÃO FLUTUANTE ===================== -->
<a href="{% url 'nova_entrada' %}" class="btn btn-primary rounded-circle floating-btn" title="Nova">
  <svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" fill="white" class="bi bi-plus" viewBox="0 0 16 16">
    <path d="M8 7v6m0-6V1m0 6H2m6 0h6" stroke="white" stroke-width="1.5" stroke-linecap="round"/>
  </svg>
</a>

{% endblock %}